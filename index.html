<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SSKH Drug Interaction Checker</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap"
      rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
    :root {
      --primary: #0b426f;
      --primary-dark: #1671cc;
      --primary-light: #BBDEFB;
      --accent: #FF4081;
      --success: #4CAF50;
      --warning: #FF9800;
      --danger: #F44336;
      --bg: #FAFAFA;
      --surface: #FFFFFF;
      --text-primary: #212121;
      --text-secondary: #757575;
      --divider: #E0E0E0;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: "Roboto", sans-serif;
      background: var(--bg);
      color: var(--text-primary);
      -webkit-font-smoothing: antialiased;
      min-height: 100vh;
    }
    
    .app-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 16px;
    }
    
    /* Material AppBar */
    .app-bar {
      background: var(--primary);
      color: white;
      padding: 16px 24px;
      border-radius: 0 0 16px 16px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      margin: -16px -16px 16px -16px;
    }
    
    .app-bar-title {
      font-size: 20px;
      font-weight: 500;
      letter-spacing: 0.15px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .app-bar-subtitle {
      font-size: 14px;
      opacity: 0.87;
      margin-top: 4px;
      font-weight: 300;
    }
    
    /* Material Card */
    .material-card {
      background: var(--surface);
      border-radius: 12px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.08), 0 4px 12px rgba(0,0,0,0.08);
      overflow: hidden;
      transition: box-shadow 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .material-card:hover {
      box-shadow: 0 4px 8px rgba(0,0,0,0.12), 0 8px 24px rgba(0,0,0,0.12);
    }
    
    .card-content {
      padding: 16px;
    }
    
    .card-title {
      font-size: 18px;
      font-weight: 500;
      color: var(--text-primary);
      margin-bottom: 16px;
      letter-spacing: 0.15px;
    }
    
    /* Material TextField */
    .text-field {
      position: relative;
      margin-bottom: 16px;
    }
    
    .text-field label {
      font-size: 12px;
      color: var(--text-secondary);
      margin-bottom: 4px;
      display: block;
      font-weight: 400;
      letter-spacing: 0.4px;
    }
    
    .text-field input {
      width: 100%;
      padding: 12px 16px;
      border: 1px solid var(--divider);
      border-radius: 8px;
      font-size: 16px;
      background: var(--surface);
      color: var(--text-primary);
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      font-family: "Roboto", sans-serif;
    }

    .input-wrapper {
      position: relative;
    }

    .clear-btn {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      background: transparent;
      border: none;
      cursor: pointer;
      font-size: 24px;
      line-height: 1;
      color: var(--text-secondary);
      padding: 0 4px;
      display: none;
    }

    .input-wrapper input:not(:placeholder-shown) + .clear-btn {
      display: block;
    }
    
    .text-field input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.1);
    }
    
    .text-field input::placeholder {
      color: var(--text-secondary);
      opacity: 0.6;
    }
    
    /* Material Button */
    .material-btn {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      letter-spacing: 0.75px;
      text-transform: uppercase;
      cursor: pointer;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      font-family: "Roboto", sans-serif;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.12);
    }
    
    .material-btn:active {
      transform: scale(0.98);
    }
    
    .material-btn-primary {
      background: var(--success);
      color: white;
    }
    
    .material-btn-primary:hover {
      background: var(--primary-dark);
      box-shadow: 0 4px 8px rgba(0,0,0,0.16);
    }
    
    .material-btn-outlined {
      background: transparent;
      color: var(--primary);
      border: 1px solid var(--primary);
      box-shadow: none;
    }
    
    .material-btn-outlined:hover {
      background: rgba(33, 150, 243, 0.04);
    }
    
    /* Material Chip */
    .chip {
      display: inline-flex;
      align-items: center;
      padding: 6px 12px;
      border-radius: 16px;
      font-size: 13px;
      font-weight: 500;
      letter-spacing: 0.25px;
      white-space: nowrap;
    }
    
    .chip-success {
      background: #E8F5E9;
      color: #2E7D32;
    }
    
    .chip-warning {
      background: #FFF3E0;
      color: #E65100;
    }
    
    .chip-error {
      background: #FFEBEE;
      color: #C62828;
    }
    
    /* Material Table */
    .table-container {
      overflow: auto;
      max-height: 60vh;
      border-radius: 8px;
      border: 1px solid var(--divider);
    }
    
    .material-table {
      width: 100%;
      border-collapse: collapse;
      background: var(--surface);
    }
    
    .material-table thead {
      position: sticky;
      top: 0;
      z-index: 10;
    }
    
    .material-table thead th {
      background: var(--accent);
      color: white;
      padding: 12px 16px;
      text-align: left;
      font-weight: 500;
      font-size: 14px;
      letter-spacing: 0.25px;
      border: none;
      white-space: nowrap;
    }
    
    .material-table tbody tr {
      border-bottom: 1px solid var(--divider);
      transition: background 0.15s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .material-table tbody tr:hover {
      background: rgba(0, 0, 0, 0.02);
    }
    
    .material-table tbody td {
      padding: 12px 16px;
      font-size: 14px;
      color: var(--text-primary);
      vertical-align: middle;
    }
    
    /* Material Divider */
    .divider {
      height: 1px;
      background: var(--divider);
      margin: 16px 0;
    }
    
    /* FloatingActionButton style for search */
    .search-container {
      position: relative;
    }
    
    .search-icon {
      position: absolute;
      left: 16px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-secondary);
      font-size: 20px;
    }
    
    .search-input {
      padding-left: 48px !important;
    }
    
    /* Info Card */
    .info-card {
      background: rgba(33, 150, 243, 0.04);
      border-left: 4px solid var(--primary);
      padding: 12px 16px;
      border-radius: 4px;
      margin-top: 16px;
    }
    
    .info-card-title {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-primary);
      margin-bottom: 8px;
    }
    
    .info-card-content {
      font-size: 13px;
      color: var(--text-secondary);
      line-height: 1.5;
    }
    
    /* Bottom Sheet style footer */
    .bottom-sheet {
      background: var(--surface);
      border-radius: 16px 16px 0 0;
      box-shadow: 0 -2px 8px rgba(0,0,0,0.1);
      padding: 16px;
      margin: 16px -16px -16px -16px;
    }
    
    .bottom-sheet-content {
      font-size: 13px;
      color: var(--text-secondary);
      line-height: 1.6;
    }
    
    /* Loading indicator */
    .loader {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(33, 150, 243, 0.2);
      border-radius: 50%;
      border-top-color: var(--primary);
      animation: spin 0.8s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .app-container {
        padding: 8px;
      }
      
      .app-bar {
        padding: 12px 16px;
        margin: -8px -8px 12px -8px;
      }
      
      .app-bar-title {
        font-size: 18px;
      }
      
      .card-content {
        padding: 12px;
      }
      
      .material-btn {
        width: 100%;
        padding: 14px 24px;
      }
      
      .material-table thead th,
      .material-table tbody td {
        padding: 10px 8px;
        font-size: 13px;
      }
      
      .chip {
        font-size: 11px;
        padding: 4px 8px;
      }
      
      .table-container {
        max-height: 50vh;
      }
      
      .bottom-sheet {
        margin: 12px -8px -8px -8px;
      }
    }
    
    @media (max-width: 576px) {
      .material-table thead th,
      .material-table tbody td {
        padding: 8px 6px;
      }
    }
  </style>
  </head>
  <body>
    <div class="app-container">
      <div class="app-bar">
        <div class="app-bar-title">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM17 13H13V17H11V13H7V11H11V7H13V11H17V13Z" />
          </svg>
          Drug Interaction Checker
        </div>
        <div class="app-bar-subtitle">โรงพยาบาลศรีสะเกษ -
          ระบบตรวจสอบปฏิกิริยาระหว่างยา</div>
      </div>

      <div class="row g-3">
        <div class="col-12 col-lg-5">
          <div class="material-card">
            <div class="card-content">
              <div class="card-title">ตรวจสอบคู่ยา</div>

              <div class="row g-3">
                <div class="col-6">
                  <div class="text-field">
                    <label>ยาตัวที่ 1</label>
                    <div class="input-wrapper">
                      <input id="drugA" list="drugListA"
                        placeholder="พิมพ์ชื่อยา..." autocomplete="off">
                      <button class="clear-btn"
                        data-target="drugA">&times;</button>
                    </div>
                  </div>
                </div>
                <div class="col-6">
                  <div class="text-field">
                    <label>ยาตัวที่ 2</label>
                    <div class="input-wrapper">
                      <input id="drugB" list="drugListB"
                        placeholder="พิมพ์ชื่อยา..." autocomplete="off">
                      <button class="clear-btn"
                        data-target="drugB">&times;</button>
                    </div>
                  </div>
                </div>
              </div>

              <button class="material-btn material-btn-primary w-100"
                id="btnCheck">
                <svg width="20" height="20" viewBox="0 0 24 24"
                  fill="currentColor">
                  <path
                    d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
                </svg>
                ตรวจสอบ
              </button>

              <datalist id="drugListA"></datalist>
              <datalist id="drugListB"></datalist>

              <div class="info-card">
                <div class="info-card-title">ระดับความรุนแรง</div>
                <div class="d-flex gap-2 flex-wrap">
                  <span class="chip chip-success">ต่ำ - Low</span>
                  <span class="chip chip-warning">ปานกลาง - Moderate</span>
                  <span class="chip chip-error">สูง - High</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-12 col-lg-7">
          <div class="material-card">
            <div class="card-content">
              <div class="card-title">รายการข้อมูลทั้งหมด</div>

              <div class="row g-2 mb-3">
                <div class="col-12 col-sm-8">
                  <div class="search-container">
                    <svg class="search-icon" width="20" height="20"
                      viewBox="0 0 24 24" fill="currentColor">
                      <path
                        d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
                    </svg>
                    <input id="search" class="text-field input search-input"
                      placeholder="ค้นหา..." style="width: 100%; margin: 0;">
                  </div>
                </div>
                <div class="col-12 col-sm-4">
                  <button class="material-btn material-btn-outlined w-100"
                    id="btnExport">
                    <svg width="20" height="20" viewBox="0 0 24 24"
                      fill="currentColor">
                      <path
                        d="M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z" />
                    </svg>
                    Export
                  </button>
                </div>
              </div>

              <div class="table-container">
                <table class="material-table">
                  <thead>
                    <tr>
                      <th>ย่อ</th>
                      <th>ยาหลัก</th>
                      <th>ยาปฏิกิริยา</th>
                      <th>ระดับ</th>
                      <th class="d-none d-md-table-cell">กลไก</th>
                      <th class="d-none d-lg-table-cell">เริ่มมีฤทธิ์</th>
                      <th class="d-none d-lg-table-cell">หมดฤทธิ์</th>
                      <th class="d-none d-lg-table-cell">ติดตาม INR</th>
                    </tr>
                  </thead>
                  <tbody id="tbody">
                    <tr>
                      <td colspan="8"
                        style="text-align: center; padding: 40px;">
                        <div class="loader" style="margin: 0 auto 12px;"></div>
                        <div
                          style="color: var(--text-secondary);">กำลังโหลดข้อมูล...</div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="bottom-sheet">
        <div class="bottom-sheet-content">
          <strong style="color: var(--danger);">⚠️ คำเตือน:</strong>
          ระบบนี้ใช้เพื่อการตรวจสอบเบื้องต้นเท่านั้น
          ไม่ทดแทนการตัดสินใจทางคลินิก
          คำปรึกษาจากเภสัชกร หรือระบบ CPOE ของโรงพยาบาล
          กรุณาตรวจสอบกับแหล่งข้อมูลทางการแพทย์อย่างเป็นทางการก่อนการใช้งานจริง
        </div>
      </div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
    const $ = (id) => document.getElementById(id);
    const API_URL = "https://script.google.com/macros/s/AKfycbwDh_ui4STIJhjUyJwyPZKs9Pxj3NbM92K4Gt2u2nbFuArqUhDdTVyzt4MpgnVpevEvcg/exec";
    let db = [];
    let allDrugs = [];

    function updateDrugList(inputId, listId) {
      const input = $(inputId);
      const list = $(listId);
      const filter = input.value.toLowerCase();

      if (filter.length < 1) {
        list.innerHTML = '';
        return;
      }

      const filteredDrugs = allDrugs.filter(d => d.toLowerCase().includes(
        filter));
      list.innerHTML = filteredDrugs.map(d =>
        `<option value="${d}"></option>`).join("");
    }

    function normalizeDrug(name) {
      return name.trim().replace(/\s+/g, ' ');
    }

    function levelChip(level) {
      const lv = (level || "").toLowerCase();
      if (lv.includes("สูง")) return `<span class="chip chip-error">${level}</span>`;
      if (lv.includes("กลาง")) return `<span class="chip chip-warning">${level}</span>`;
      return `<span class="chip chip-success">${level}</span>`;
    }

    async function loadFromSheet() {
      try {
        const res = await fetch(API_URL + "?action=list");
        const data = await res.json();
        db = data;
        renderTable();

        allDrugs = [...new Set(data.flatMap(it => [it["รายการยา"], it[
          "ยาปฏิกิริยา"]]))].filter(Boolean);
      } catch (error) {
        console.error("Error loading data:", error);
        $("tbody").innerHTML = `
          <tr>
            <td colspan="8" style="text-align: center; padding: 40px; color: var(--danger);">
              <div style="font-size: 48px; margin-bottom: 12px;">❌</div>
              <div style="font-weight: 500;">เกิดข้อผิดพลาดในการโหลดข้อมูล</div>
              <div style="color: var(--text-secondary); margin-top: 8px; font-size: 13px;">กรุณาลองใหม่อีกครั้ง</div>
            </td>
          </tr>
        `;
        Swal.fire({
          icon: "error",
          title: "เกิดข้อผิดพลาด",
          text: "ไม่สามารถโหลดข้อมูลได้ กรุณาลองใหม่อีกครั้ง",
          confirmButtonColor: "#2196F3",
          confirmButtonText: "ตกลง"
        });
      }
    }

    function renderTable(filter = '') {
      const tbody = $('tbody');
      const q = filter.trim().toLowerCase();
      const filtered = db.filter(it => {
        if (!q) return true;
        return Object.values(it).some(val => 
          String(val).toLowerCase().includes(q)
        );
      });

      if (filtered.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="8" style="text-align: center; padding: 40px; color: var(--text-secondary);">
              <div style="font-size: 48px; margin-bottom: 12px;">🔍</div>
              <div style="font-weight: 500;">ไม่พบข้อมูล</div>
              <div style="font-size: 13px; margin-top: 8px;">ลองใช้คำค้นหาอื่น</div>
            </td>
          </tr>
        `;
        return;
      }

      tbody.innerHTML = filtered.map(it => `
        <tr>
          <td><strong>${it["ชื่อย่อ"] || ""}</strong></td>
          <td>${it["รายการยา"] || ""}</td>
          <td>${it["ยาปฏิกิริยา"] || ""}</td>
          <td>${levelChip(it["ผลลัพธ์"] || "")}</td>
          <td class="d-none d-md-table-cell" style="color: var(--text-secondary);">${it["กลไก"] || "-"}</td>
          <td class="d-none d-lg-table-cell" style="color: var(--text-secondary);">${it["เริ่มมีฤทธิ์ต่อกัน"] || "-"}</td>
          <td class="d-none d-lg-table-cell" style="color: var(--text-secondary);">${it["เริ่มหมดฤทธิ์ต่อกัน"] || "-"}</td>
          <td class="d-none d-lg-table-cell" style="color: var(--text-secondary);">${it["ติดตามค่า INR ทุก"] || "-"}</td>
        </tr>
      `).join("");
    }

    function checkPair() {
      const a = normalizeDrug($('drugA').value).toLowerCase();
      const b = normalizeDrug($('drugB').value).toLowerCase();
      
      if (!a || !b) {
        return Swal.fire({
          icon: 'warning',
          title: 'กรอกข้อมูลไม่ครบ',
          text: 'กรุณาใส่ชื่อยาให้ครบทั้ง 2 ช่อง',
          confirmButtonColor: '#2196F3',
          confirmButtonText: 'ตกลง'
        });
      }

      const results = db.filter(item => {
        if (!item['รายการยา'] || !item["ยาปฏิกิริยา"]) return false;
        const A = item['รายการยา'].toLowerCase();
        const B = item["ยาปฏิกิริยา"].toLowerCase();
        return (
          (A.includes(a) && B.includes(b)) ||
          (A.includes(b) && B.includes(a))
        );
      });

      if (results.length > 0) {
        const found = results[0];
        const chipHtml = levelChip(found['ผลลัพธ์']);
        
        Swal.fire({
          icon: 'error',
          title: '⚠️ พบปฏิกิริยาระหว่างยา',
          html: `
            <div style="text-align: left; padding: 16px; background: #FAFAFA; border-radius: 8px; margin: 16px 0;">
              <div style="background: white; padding: 16px; border-radius: 8px; margin-bottom: 12px; border-left: 4px solid #F44336;">
                <div style="font-size: 18px; font-weight: 500; color: #212121; margin-bottom: 8px;">
                  <strong>${found['รายการยา']}</strong> + <strong>${found["ยาปฏิกิริยา"]}</strong>
                </div>
                <div style="margin-top: 8px;">
                  <span style="color: #757575; font-size: 14px; margin-right: 8px;">ระดับความรุนแรง:</span>
                  ${chipHtml}
                </div>
              </div>
              
              <div style="background: white; padding: 12px; border-radius: 8px; margin-bottom: 8px;">
                <div style="color: #2196F3; font-weight: 500; margin-bottom: 4px;">⚙️ กลไก</div>
                <div style="color: #757575; font-size: 14px;">${found['กลไก'] || '-'}</div>
              </div>
              
              <div style="background: white; padding: 12px; border-radius: 8px; margin-bottom: 8px;">
                <div style="color: #2196F3; font-weight: 500; margin-bottom: 4px;">⏱️ เริ่มมีฤทธิ์ต่อกัน</div>
                <div style="color: #757575; font-size: 14px;">${found['เริ่มมีฤทธิ์ต่อกัน'] || '-'}</div>
              </div>
              
              <div style="background: white; padding: 12px; border-radius: 8px; margin-bottom: 8px;">
                <div style="color: #2196F3; font-weight: 500; margin-bottom: 4px;">⏰ เริ่มหมดฤทธิ์ต่อกัน</div>
                <div style="color: #757575; font-size: 14px;">${found['เริ่มหมดฤทธิ์ต่อกัน'] || '-'}</div>
              </div>
              
              <div style="background: white; padding: 12px; border-radius: 8px;">
                <div style="color: #2196F3; font-weight: 500; margin-bottom: 4px;">🩺 ติดตามค่า INR ทุก</div>
                <div style="color: #757575; font-size: 14px;">${found['ติดตามค่า INR ทุก'] || '-'}</div>
              </div>
            </div>
          `,
          confirmButtonText: 'รับทราบ',
          confirmButtonColor: '#2196F3',
          width: '600px'
        });
      } else {
        Swal.fire({
          icon: 'success',
          title: '✅ ไม่พบปฏิกิริยา',
          text: 'ไม่พบข้อมูลปฏิกิริยาระหว่างยาคู่นี้ในระบบ',
          confirmButtonColor: '#4CAF50',
          confirmButtonText: 'ตกลง'
        });
      }
    }

    function exportJson() {
      const blob = new Blob([JSON.stringify(db, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `drug_interactions_${new Date().toISOString().split('T')[0]}.json`;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
      
      Swal.fire({
        icon: 'success',
        title: 'ส่งออกสำเร็จ',
        text: 'ดาวน์โหลดไฟล์ข้อมูลเรียบร้อยแล้ว',
        confirmButtonColor: '#4CAF50',
        confirmButtonText: 'ตกลง',
        timer: 2000,
        timerProgressBar: true
      });
    }

    // Event listeners
    $('btnCheck').addEventListener('click', checkPair);
    $('btnExport').addEventListener('click', exportJson);
    $('search').addEventListener('input', (e) => renderTable(e.target.value));

    ['drugA', 'drugB'].forEach(id => {
      const input = $(id);
      input.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') checkPair();
      });
      input.addEventListener('input', () => updateDrugList(id, id.replace(
        'drug', 'drugList')));
    });

    document.querySelectorAll('.clear-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const targetId = btn.dataset.target;
        const input = $(targetId);
        input.value = '';
        input.focus();
        updateDrugList(targetId, targetId.replace('drug', 'drugList'));
      });
    });

    // Initialize
    loadFromSheet();
  </script>
  </body>
</html>
